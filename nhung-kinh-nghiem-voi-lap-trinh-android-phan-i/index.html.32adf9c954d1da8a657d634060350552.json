{"head":{"id":11228,"layout":"Post","route":"nhung-kinh-nghiem-voi-lap-trinh-android-phan-i","title":"Những kinh nghiệm với lập trình Android - Phần I","tags":["android"],"date":"2015-08-17T07:32:43.343Z","views":1647,"likes":33,"description":"Tóm tắt\n\nCó một vài topic như thế này khiến mình rất bối rối không biết phải trả lời như thế nào cho hợp lí. Vậy nên lập thêm một topic mới…","author":{"name":"Google Developer Group Hà Nội Android Team","avatar":"/user_avatar/daynhauhoc.com/gdghn_androidteam/{size}/3567_1.png","username":"GDGHN_AndroidTeam"}},"body":"\n<h2>Tóm tắt</h2>\n\n<p><a href=\"http://daynhauhoc.com/t/can-tai-lieu-phan-giao-dien-android/11099/7\">Có một vài topic như thế này</a> khiến mình rất bối rối không biết phải trả lời như thế nào cho hợp lí. Vậy nên lập thêm một topic mới chia sẻ kinh nghiệm chung nhất của mình về lập trình Android. Đây là những kinh nghiệm khi mình thực hiện maintain lại một dự án trong hai năm và làm một vài dự án nhỏ nữa nên không chắc là những kinh nghiệm tốt nhất. Tuy nhiên vẫn hi vọng chúng có ích<br>  </p>\n\n<h2>Cấu trúc thư mục cho code Android</h2>\n\n<p>Mục này mình có tham khảo ở nhiều nguồn để ghép vào phần dự án mình đang làm. Theo mình thấy thì dự án chia cây thư mục như sau sẽ rõ ràng hơn các cách chia khác.</p>\n\n<p></p><pre><code class=\"lang-auto\">Android_structure\n├─ gdg.lbs\n│  ├─ activities\n│  ├─ adapters\n│  ├─ fragments\n│  ├─ example\n│  ├─ interfaces\n│  ├─ models\n│  ├─ navigates\n│  ├─ networks\n│  ├─ notifications\n│  ├─ utils\n│  └─ views</code></pre>\n\n<p>Trong đó mỗi một thành phần sẽ có một ý nghĩa riêng như sau:</p>\n\n<blockquote><p><strong>gdg</strong>: Tên công ty (đồng thời nằm trong root package name)<br><strong>lbs</strong>: Viết tắt của Lương Sơn Bạc là tên của team<br><strong>activities</strong>: Các activity sẽ được đưa vào đây.<br><strong>adapters</strong>: Dành cho các custom adapter.<br><strong>fragments</strong>: Toàn bộ các fragment<br><strong>example</strong>: Tên của project. Trong này sẽ chứa tất cả những gì liên quan tới project bao gồm file Config.java, Application.java...<br><strong>interfaces</strong>: Khai báo các interface được dùng trong dự án<br><strong>models</strong>: Làm việc với preference, làm việc với SQLlite<br><strong>navigates</strong>: Các phương thức điều khiển vào ra của fragment sẽ được đưa vào đây.<br><strong>networks</strong>: Picaso. Volley, OKHttp sẽ được đưa vào đây.<br><strong>notifications</strong>: Tất cả mọi hoạt động liên quan đến notification, GCM.<br><strong>utils</strong>: Các lớp hỗ trợ trọng quá trình sử dụng như StorageUtil.java, ImageUtil.java...<br><strong>views</strong>: Khai báo các custom view</p></blockquote>\n\n<p>Ngoài những thư mục (package) kể trên thì mình còn sử dụng thêm một vài package nữa tuy nhiên không phổ biến lắm nên mình không có liệt kê tại đây.</p>\n\n<h2>Sử dụng DebugLog.java thay vì Log.java</h2>\n\n<p>Thông thường khi muốn viêt lại log để hỗ trợ việc debug android được tốt hơn, các bạn sẽ sử dụng lớp được cũng cấp sẵn là <code>Log.i(String, String);</code>. Tuy nhiên vấn đề bạn đang gặp phải là những đoạn log này chỉ hữu ích với việc debug mà thôi. Khi sản phẩm được tung ra thị trường thì những đoạn log này vô tình lại đang làm hại chính các bạn. Vậy trong trường hợp này ta phải làm sao? <strong>Chẳng lẽ lại tìm từng chỗ viết log rồi xóa tay trước khi build?</strong></p>\n\n<p>Một gợi ý nhỏ đó là chúng ta sẽ sử dụng một biến static có tên là <code>IS_DEBUG</code> như sau:<br></p>\n\n<p></p><pre><code class=\"lang-auto\">if (Config.IS_DEBUG) {\n    Log.i(String, String);\n}</code></pre>\n\n<p>Cũng khá ổn rồi nhưng mà bây giờ mỗi lần sử dụng <strong>chẳng lẽ lại viết đi viết lại mất công quá</strong>. Chưa kể là thành viên mới vào team có khi còn quên việc phải sử dụng code như vậy nữa. Vậy nên chăng ta nên sử dụng một lớp là <code>DebugLog.java</code> như sau:<br></p>\n\n<p></p><pre><code class=\"lang-auto\">public class DebugLog {\n    public static void i(String tag, String msg) {\n        if (Config.IS_DEBUG) {\n            Log.i(tag, msg);\n        }\n    }\n}</code></pre>\n\n<p>Tốt rồi, code đã trở nên sáng sủa hơn nhiều.Thế nhưng có một vấn đề nhỏ với DebugLog.<br></p>\n\n<p></p><pre><code class=\"lang-auto\">DebugLog.i(TAG, \"String: \" + numberOfString);</code></pre>\n\n<p>Đoạn code trên tưởng chừng như vô hai nhưng lại khiến cho ta tốn thêm 4 bước thuật toán cộng chuỗi trong khi chuỗi mới chẳng được sử dụng nếu cờ <code>IS_DEBUG</code> được đặt bằng <code>false</code>. <strong>Vậy cách giải quyết ở đây là gì nhỉ?</strong><br>Chẳng có cách nào để khắc phục việc này đâu. Hãy coi đây là một cái giá phải trả cho việc quản lí dễ dàng hơn.</p>\n\n<h2>Lưu mật khẩu signing key vào file <code>gradle.properties</code>\n</h2>\n\n<p></p><pre><code class=\"lang-auto\">signingConfigs {\n    release {\n        storeFile file(\"release.keystore\")\n        storePassword \"storepassword\"\n        keyAlias \"myproject\"\n        keyPassword \"keypassword\"\n    }\n}</code></pre>\n\n<p>Sau đó bạn đẩy file này lên version control như GIT hoặc SVN. Tình cờ thế nào ai đó có quyền truy cập vào version control của bạn. Và bạn mất đi signing key, một trong những chìa khóa cốt lõi cho file apk của bạn trên GooglePlay.<br>Một giải pháp cho vấn đề này là chúng ta sẽ sử dụng file <code>gradle.properties</code> như sau:<br></p>\n\n<p></p><pre><code class=\"lang-auto\">KEYSTORE_PASSWORD=storepassword\nKEY_PASSWORD=keypassword</code></pre>\n\n<p>Và thay vì viết một kịch bản như trên, bạn có cách viết lại khác hơn nhiều:<br></p>\n\n<p></p><pre><code class=\"lang-auto\">signingConfigs {\n    release {\n        try {\n            storeFile file(\"release.keystore\")\n            storePassword KEYSTORE_PASSWORD\n            keyAlias \"myproject\"\n            keyPassword KEY_PASSWORD\n        }\n        catch (ex) {\n            throw new InvalidUserDataException(\"You should define KEYSTORE_PASSWORD and KEY_PASSWORD in gradle.properties.\")\n        }\n    }\n}</code></pre>\n\n<p>Lúc này, chúng ta chỉ cần pull kịch bản lên version control và giữ lại password cho riêng mình.</p>\n","rawBody":"\n<h2>Tóm tắt</h2>\n\n<p><a href=\"http://daynhauhoc.com/t/can-tai-lieu-phan-giao-dien-android/11099/7\">Có một vài topic như thế này</a> khiến mình rất bối rối không biết phải trả lời như thế nào cho hợp lí. Vậy nên lập thêm một topic mới chia sẻ kinh nghiệm chung nhất của mình về lập trình Android. Đây là những kinh nghiệm khi mình thực hiện maintain lại một dự án trong hai năm và làm một vài dự án nhỏ nữa nên không chắc là những kinh nghiệm tốt nhất. Tuy nhiên vẫn hi vọng chúng có ích<br>  </p>\n\n<h2>Cấu trúc thư mục cho code Android</h2>\n\n<p>Mục này mình có tham khảo ở nhiều nguồn để ghép vào phần dự án mình đang làm. Theo mình thấy thì dự án chia cây thư mục như sau sẽ rõ ràng hơn các cách chia khác.</p>\n\n<p></p><pre><code class=\"lang-auto\">Android_structure\n├─ gdg.lbs\n│  ├─ activities\n│  ├─ adapters\n│  ├─ fragments\n│  ├─ example\n│  ├─ interfaces\n│  ├─ models\n│  ├─ navigates\n│  ├─ networks\n│  ├─ notifications\n│  ├─ utils\n│  └─ views</code></pre>\n\n<p>Trong đó mỗi một thành phần sẽ có một ý nghĩa riêng như sau:</p>\n\n<blockquote><p><strong>gdg</strong>: Tên công ty (đồng thời nằm trong root package name)<br><strong>lbs</strong>: Viết tắt của Lương Sơn Bạc là tên của team<br><strong>activities</strong>: Các activity sẽ được đưa vào đây.<br><strong>adapters</strong>: Dành cho các custom adapter.<br><strong>fragments</strong>: Toàn bộ các fragment<br><strong>example</strong>: Tên của project. Trong này sẽ chứa tất cả những gì liên quan tới project bao gồm file Config.java, Application.java...<br><strong>interfaces</strong>: Khai báo các interface được dùng trong dự án<br><strong>models</strong>: Làm việc với preference, làm việc với SQLlite<br><strong>navigates</strong>: Các phương thức điều khiển vào ra của fragment sẽ được đưa vào đây.<br><strong>networks</strong>: Picaso. Volley, OKHttp sẽ được đưa vào đây.<br><strong>notifications</strong>: Tất cả mọi hoạt động liên quan đến notification, GCM.<br><strong>utils</strong>: Các lớp hỗ trợ trọng quá trình sử dụng như StorageUtil.java, ImageUtil.java...<br><strong>views</strong>: Khai báo các custom view</p></blockquote>\n\n<p>Ngoài những thư mục (package) kể trên thì mình còn sử dụng thêm một vài package nữa tuy nhiên không phổ biến lắm nên mình không có liệt kê tại đây.</p>\n\n<h2>Sử dụng DebugLog.java thay vì Log.java</h2>\n\n<p>Thông thường khi muốn viêt lại log để hỗ trợ việc debug android được tốt hơn, các bạn sẽ sử dụng lớp được cũng cấp sẵn là <code>Log.i(String, String);</code>. Tuy nhiên vấn đề bạn đang gặp phải là những đoạn log này chỉ hữu ích với việc debug mà thôi. Khi sản phẩm được tung ra thị trường thì những đoạn log này vô tình lại đang làm hại chính các bạn. Vậy trong trường hợp này ta phải làm sao? <strong>Chẳng lẽ lại tìm từng chỗ viết log rồi xóa tay trước khi build?</strong></p>\n\n<p>Một gợi ý nhỏ đó là chúng ta sẽ sử dụng một biến static có tên là <code>IS_DEBUG</code> như sau:<br></p>\n\n<p></p><pre><code class=\"lang-auto\">if (Config.IS_DEBUG) {\n    Log.i(String, String);\n}</code></pre>\n\n<p>Cũng khá ổn rồi nhưng mà bây giờ mỗi lần sử dụng <strong>chẳng lẽ lại viết đi viết lại mất công quá</strong>. Chưa kể là thành viên mới vào team có khi còn quên việc phải sử dụng code như vậy nữa. Vậy nên chăng ta nên sử dụng một lớp là <code>DebugLog.java</code> như sau:<br></p>\n\n<p></p><pre><code class=\"lang-auto\">public class DebugLog {\n    public static void i(String tag, String msg) {\n        if (Config.IS_DEBUG) {\n            Log.i(tag, msg);\n        }\n    }\n}</code></pre>\n\n<p>Tốt rồi, code đã trở nên sáng sủa hơn nhiều.Thế nhưng có một vấn đề nhỏ với DebugLog.<br></p>\n\n<p></p><pre><code class=\"lang-auto\">DebugLog.i(TAG, \"String: \" + numberOfString);</code></pre>\n\n<p>Đoạn code trên tưởng chừng như vô hai nhưng lại khiến cho ta tốn thêm 4 bước thuật toán cộng chuỗi trong khi chuỗi mới chẳng được sử dụng nếu cờ <code>IS_DEBUG</code> được đặt bằng <code>false</code>. <strong>Vậy cách giải quyết ở đây là gì nhỉ?</strong><br>Chẳng có cách nào để khắc phục việc này đâu. Hãy coi đây là một cái giá phải trả cho việc quản lí dễ dàng hơn.</p>\n\n<h2>Lưu mật khẩu signing key vào file <code>gradle.properties</code>\n</h2>\n\n<p></p><pre><code class=\"lang-auto\">signingConfigs {\n    release {\n        storeFile file(\"release.keystore\")\n        storePassword \"storepassword\"\n        keyAlias \"myproject\"\n        keyPassword \"keypassword\"\n    }\n}</code></pre>\n\n<p>Sau đó bạn đẩy file này lên version control như GIT hoặc SVN. Tình cờ thế nào ai đó có quyền truy cập vào version control của bạn. Và bạn mất đi signing key, một trong những chìa khóa cốt lõi cho file apk của bạn trên GooglePlay.<br>Một giải pháp cho vấn đề này là chúng ta sẽ sử dụng file <code>gradle.properties</code> như sau:<br></p>\n\n<p></p><pre><code class=\"lang-auto\">KEYSTORE_PASSWORD=storepassword\nKEY_PASSWORD=keypassword</code></pre>\n\n<p>Và thay vì viết một kịch bản như trên, bạn có cách viết lại khác hơn nhiều:<br></p>\n\n<p></p><pre><code class=\"lang-auto\">signingConfigs {\n    release {\n        try {\n            storeFile file(\"release.keystore\")\n            storePassword KEYSTORE_PASSWORD\n            keyAlias \"myproject\"\n            keyPassword KEY_PASSWORD\n        }\n        catch (ex) {\n            throw new InvalidUserDataException(\"You should define KEYSTORE_PASSWORD and KEY_PASSWORD in gradle.properties.\")\n        }\n    }\n}</code></pre>\n\n<p>Lúc này, chúng ta chỉ cần pull kịch bản lên version control và giữ lại password cho riêng mình.</p>\n","raw":"---json\n{\"id\":11228,\"layout\":\"Post\",\"route\":\"nhung-kinh-nghiem-voi-lap-trinh-android-phan-i\",\"title\":\"Những kinh nghiệm với lập trình Android - Phần I\",\"tags\":[\"android\"],\"date\":\"2015-08-17T07:32:43.343Z\",\"views\":1647,\"likes\":33,\"description\":\"Tóm tắt\\n\\nCó một vài topic như thế này khiến mình rất bối rối không biết phải trả lời như thế nào cho hợp lí. Vậy nên lập thêm một topic mới…\",\"author\":{\"name\":\"Google Developer Group Hà Nội Android Team\",\"avatar\":\"/user_avatar/daynhauhoc.com/gdghn_androidteam/{size}/3567_1.png\",\"username\":\"GDGHN_AndroidTeam\"}}\n---\n\n<h2>Tóm tắt</h2>\n\n<p><a href=\"http://daynhauhoc.com/t/can-tai-lieu-phan-giao-dien-android/11099/7\">Có một vài topic như thế này</a> khiến mình rất bối rối không biết phải trả lời như thế nào cho hợp lí. Vậy nên lập thêm một topic mới chia sẻ kinh nghiệm chung nhất của mình về lập trình Android. Đây là những kinh nghiệm khi mình thực hiện maintain lại một dự án trong hai năm và làm một vài dự án nhỏ nữa nên không chắc là những kinh nghiệm tốt nhất. Tuy nhiên vẫn hi vọng chúng có ích<br>  </p>\n\n<h2>Cấu trúc thư mục cho code Android</h2>\n\n<p>Mục này mình có tham khảo ở nhiều nguồn để ghép vào phần dự án mình đang làm. Theo mình thấy thì dự án chia cây thư mục như sau sẽ rõ ràng hơn các cách chia khác.</p>\n\n<p></p><pre><code class=\"lang-auto\">Android_structure\n├─ gdg.lbs\n│  ├─ activities\n│  ├─ adapters\n│  ├─ fragments\n│  ├─ example\n│  ├─ interfaces\n│  ├─ models\n│  ├─ navigates\n│  ├─ networks\n│  ├─ notifications\n│  ├─ utils\n│  └─ views</code></pre>\n\n<p>Trong đó mỗi một thành phần sẽ có một ý nghĩa riêng như sau:</p>\n\n<blockquote><p><strong>gdg</strong>: Tên công ty (đồng thời nằm trong root package name)<br><strong>lbs</strong>: Viết tắt của Lương Sơn Bạc là tên của team<br><strong>activities</strong>: Các activity sẽ được đưa vào đây.<br><strong>adapters</strong>: Dành cho các custom adapter.<br><strong>fragments</strong>: Toàn bộ các fragment<br><strong>example</strong>: Tên của project. Trong này sẽ chứa tất cả những gì liên quan tới project bao gồm file Config.java, Application.java...<br><strong>interfaces</strong>: Khai báo các interface được dùng trong dự án<br><strong>models</strong>: Làm việc với preference, làm việc với SQLlite<br><strong>navigates</strong>: Các phương thức điều khiển vào ra của fragment sẽ được đưa vào đây.<br><strong>networks</strong>: Picaso. Volley, OKHttp sẽ được đưa vào đây.<br><strong>notifications</strong>: Tất cả mọi hoạt động liên quan đến notification, GCM.<br><strong>utils</strong>: Các lớp hỗ trợ trọng quá trình sử dụng như StorageUtil.java, ImageUtil.java...<br><strong>views</strong>: Khai báo các custom view</p></blockquote>\n\n<p>Ngoài những thư mục (package) kể trên thì mình còn sử dụng thêm một vài package nữa tuy nhiên không phổ biến lắm nên mình không có liệt kê tại đây.</p>\n\n<h2>Sử dụng DebugLog.java thay vì Log.java</h2>\n\n<p>Thông thường khi muốn viêt lại log để hỗ trợ việc debug android được tốt hơn, các bạn sẽ sử dụng lớp được cũng cấp sẵn là <code>Log.i(String, String);</code>. Tuy nhiên vấn đề bạn đang gặp phải là những đoạn log này chỉ hữu ích với việc debug mà thôi. Khi sản phẩm được tung ra thị trường thì những đoạn log này vô tình lại đang làm hại chính các bạn. Vậy trong trường hợp này ta phải làm sao? <strong>Chẳng lẽ lại tìm từng chỗ viết log rồi xóa tay trước khi build?</strong></p>\n\n<p>Một gợi ý nhỏ đó là chúng ta sẽ sử dụng một biến static có tên là <code>IS_DEBUG</code> như sau:<br></p>\n\n<p></p><pre><code class=\"lang-auto\">if (Config.IS_DEBUG) {\n    Log.i(String, String);\n}</code></pre>\n\n<p>Cũng khá ổn rồi nhưng mà bây giờ mỗi lần sử dụng <strong>chẳng lẽ lại viết đi viết lại mất công quá</strong>. Chưa kể là thành viên mới vào team có khi còn quên việc phải sử dụng code như vậy nữa. Vậy nên chăng ta nên sử dụng một lớp là <code>DebugLog.java</code> như sau:<br></p>\n\n<p></p><pre><code class=\"lang-auto\">public class DebugLog {\n    public static void i(String tag, String msg) {\n        if (Config.IS_DEBUG) {\n            Log.i(tag, msg);\n        }\n    }\n}</code></pre>\n\n<p>Tốt rồi, code đã trở nên sáng sủa hơn nhiều.Thế nhưng có một vấn đề nhỏ với DebugLog.<br></p>\n\n<p></p><pre><code class=\"lang-auto\">DebugLog.i(TAG, \"String: \" + numberOfString);</code></pre>\n\n<p>Đoạn code trên tưởng chừng như vô hai nhưng lại khiến cho ta tốn thêm 4 bước thuật toán cộng chuỗi trong khi chuỗi mới chẳng được sử dụng nếu cờ <code>IS_DEBUG</code> được đặt bằng <code>false</code>. <strong>Vậy cách giải quyết ở đây là gì nhỉ?</strong><br>Chẳng có cách nào để khắc phục việc này đâu. Hãy coi đây là một cái giá phải trả cho việc quản lí dễ dàng hơn.</p>\n\n<h2>Lưu mật khẩu signing key vào file <code>gradle.properties</code>\n</h2>\n\n<p></p><pre><code class=\"lang-auto\">signingConfigs {\n    release {\n        storeFile file(\"release.keystore\")\n        storePassword \"storepassword\"\n        keyAlias \"myproject\"\n        keyPassword \"keypassword\"\n    }\n}</code></pre>\n\n<p>Sau đó bạn đẩy file này lên version control như GIT hoặc SVN. Tình cờ thế nào ai đó có quyền truy cập vào version control của bạn. Và bạn mất đi signing key, một trong những chìa khóa cốt lõi cho file apk của bạn trên GooglePlay.<br>Một giải pháp cho vấn đề này là chúng ta sẽ sử dụng file <code>gradle.properties</code> như sau:<br></p>\n\n<p></p><pre><code class=\"lang-auto\">KEYSTORE_PASSWORD=storepassword\nKEY_PASSWORD=keypassword</code></pre>\n\n<p>Và thay vì viết một kịch bản như trên, bạn có cách viết lại khác hơn nhiều:<br></p>\n\n<p></p><pre><code class=\"lang-auto\">signingConfigs {\n    release {\n        try {\n            storeFile file(\"release.keystore\")\n            storePassword KEYSTORE_PASSWORD\n            keyAlias \"myproject\"\n            keyPassword KEY_PASSWORD\n        }\n        catch (ex) {\n            throw new InvalidUserDataException(\"You should define KEYSTORE_PASSWORD and KEY_PASSWORD in gradle.properties.\")\n        }\n    }\n}</code></pre>\n\n<p>Lúc này, chúng ta chỉ cần pull kịch bản lên version control và giữ lại password cho riêng mình.</p>\n","__filename":"posts/11228.md","__url":"/nhung-kinh-nghiem-voi-lap-trinh-android-phan-i/","__resourceUrl":"/nhung-kinh-nghiem-voi-lap-trinh-android-phan-i/index.html","__dataUrl":"/nhung-kinh-nghiem-voi-lap-trinh-android-phan-i/index.html.32adf9c954d1da8a657d634060350552.json"}